<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
    <title>Superior 3D Boxes Viewer</title>
    <style>
        body { margin: 0; overflow: hidden; background: #f0f0f0; font-family: sans-serif; }
        canvas { display: block; touch-action: none; }
    </style>
</head>
<body>

<script type="importmap">
{
  "imports": {
    "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
    "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/"
  }
}
</script>

<script type="module">
import * as THREE from 'three';
import { TrackballControls } from 'three/addons/controls/TrackballControls.js';

/* --- Configuration & Data --- */
const EDGES = true; // Toggle this to true or false
const boxesData = [
[-4.0, -3.5, 1.0, -2.0, -1.5, 3.0, 0x0000ff],
[-3.0, -2.5, -1.0, -2.0, -0.5, 1.0, 0x0000ff],
[-3.0, -1.5, 2.0, -1.0, 0.5, 3.0, 0x0000ff],
[-4.0, -0.5, -2.0, -2.0, 1.5, 0.0, 0xff0000],
[-3.0, 0.5, -4.0, -1.0, 1.5, -2.0, 0xff0000],
[-4.0, -2.5, -1.0, -3.0, -0.5, 1.0, 0xff0000],
[-1.0, -0.5, 1.0, 1.0, 1.5, 3.0, 0x800080],
[1.0, 0.5, 2.0, 2.0, 2.5, 4.0, 0x800080],
[-3.0, -1.5, 1.0, -1.0, 0.5, 2.0, 0x800080],
[-2.0, 1.5, -2.0, 0.0, 3.5, 0.0, 0x008000],
[-3.0, 1.5, -4.0, -1.0, 2.5, -2.0, 0x008000],
[0.0, 0.5, -1.0, 2.0, 2.5, 0.0, 0x008000],
[2.0, 1.5, 0.0, 4.0, 3.5, 2.0, 0xffa500],
[2.0, 0.5, 2.0, 3.0, 2.5, 4.0, 0xffa500],
[0.0, 0.5, 0.0, 2.0, 2.5, 1.0, 0xffa500]
];

/* --- Scene Setup --- */
const scene = new THREE.Scene();
scene.background = new THREE.Color(0xf0f0f0);

const camera = new THREE.PerspectiveCamera(40, window.innerWidth / window.innerHeight, 0.1, 1000);
camera.position.set(12, 12, 12);

const renderer = new THREE.WebGLRenderer({ antialias: true });
renderer.setPixelRatio(window.devicePixelRatio);
renderer.setSize(window.innerWidth, window.innerHeight);
document.body.appendChild(renderer.domElement);

/* --- Lighting --- */
scene.add(new THREE.AmbientLight(0xffffff, 0.7));
const dirLight = new THREE.DirectionalLight(0xffffff, 0.6);
dirLight.position.set(10, 20, 10);
scene.add(dirLight);

/* --- Controls --- */
const controls = new TrackballControls(camera, renderer.domElement);
Object.assign(controls, {
    rotateSpeed: 2.0,
    zoomSpeed: 1.2,
    //panSpeed: 0.8,
    noPan: true,
    dynamicDampingFactor: 0.15
});

/* --- Object Creation --- */
const edgeMat = new THREE.LineBasicMaterial({ color: 0x000000 });

boxesData.forEach(([x0, y0, z0, x1, y1, z1, color]) => {
    const size = new THREE.Vector3(x1 - x0, y1 - y0, z1 - z0);
    const center = new THREE.Vector3(x0 + size.x / 2, y0 + size.y / 2, z0 + size.z / 2);
    
    const geometry = new THREE.BoxGeometry(size.x, size.y, size.z);
    
    // Use polygonOffset ONLY if edges are enabled to prevent Z-fighting
    const material = new THREE.MeshLambertMaterial({ 
        color,
        polygonOffset: EDGES,
        polygonOffsetFactor: 1,
        polygonOffsetUnits: 1
    });
    
    const mesh = new THREE.Mesh(geometry, material);
    mesh.position.copy(center);
    scene.add(mesh);

    // Conditional edge creation
    if (EDGES) {
        const edges = new THREE.LineSegments(new THREE.EdgesGeometry(geometry), edgeMat);
        edges.position.copy(center);
        scene.add(edges);
    }
});

/* --- Animation Loop --- */
renderer.setAnimationLoop(() => {
    controls.update();
    renderer.render(scene, camera);
});

</script>
</body>
</html>
