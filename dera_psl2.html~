<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Verification script</title>
    <link rel="stylesheet" type="text/css" href="pm.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
    <script src="https://sagecell.sagemath.org/static/embedded_sagecell.js"></script>
<script>sagecell.makeSagecell({"inputLocation": ".sage"});</script>
</head>
<body>
  <H3>Verification script for the paper <em>Transitive sets of derangements in primitive actions of PSL<sub>2</sub>(q)</em></H3>
  This page provides the SageMath script which confirms the
  computational parts of ???. You can
  <UL>
    <LI> Download the SageMath
      script <a href="Code/dera_psl2.sage">dera_psl2.sage</a></li>
    <LI> Run and view the code in <a href="https://sagecell.sagemath.org/">SageCell</a>. To do so, just click the <b>Evaluate</b> button below:
      <div class="sage">
  <script type="text/x-sage">from itertools import product

# Corollary ???
for q in [z for z in range(5, 21, 2) if is_prime_power(z)]:
    F = GF(q)
    S = {r + 1/r for r in F if r != 0}
    S.add(F.zero())
    for a, b, c, d in product(F, repeat=4):
        if a*d - b*c == 1:
            if all(a*r + d/r in S and -c*r + b/r in S for r in F if r != 0):
                assert ((a == d == 0 or b == c == 0) or
                        (q == 9 and F(2) in {a*r + d/r for r in F if r != 0}))

# Corollary ???
for q in [z for z in range(3, 21, 2) if is_prime_power(z)]:
    F = GF(q^2)
    S = {r + 1/r for r in F if r^(q+1) == 1}
    S.add(F.zero())
    for a, b in product(F, repeat=2):
        if a^(q+1) + b^(q+1) == 1:
            if all(a*r + a^(q+1)/r in S and b*r + b^(q+1)/r in S for
                   r in F if r^(q+1) == 1):
                assert a == 0 or b == 0

def gener(L):
    # Compute matrix group generated by the matrices in L
    S = {matrix(z, immutable=True) for z in L}
    flag = True
    while flag:
        C = S.copy()
        flag = False
        for x in L:
            for y in S:
                xy = matrix(x*y, immutable=True)
                if xy not in C:
                    C.add(xy)
                    flag = True
        S = C.copy()
    return S

catal = [1, 2, 5, 14, 42]

# H = A_4 (Case (d))
F.<i> = QuadraticField(-1)
S.<a, b, c, d, A, B, C, D> = F[]
I = matrix(S, 2, [i, 0, 0, -i])
J = matrix(S, 2, [0, 1, -1, 0])
K = I*J
W = (-matrix.identity(S, 2) + I + J + K)/2
Hhat = gener([I, W])
X = matrix(2, [a, b, c, d])
Y = matrix(2, [A, B, C, D])
T = {z.trace() for z in Hhat} - {-2, 2}
assert prod(A - t for t in T) == A^3 - A
txy = X.trace()*Y.trace() - (X*Y).trace()
det = X.det()
for m in [0, 1]:
    s = sum((h*Y).trace()*(h*X).trace()^(2*m+1) for h in Hhat)
    assert 2*s == len(Hhat)*catal[m]*txy*det^m

# H = S_4 (Case (e))
N.<i> = QuadraticField(-1)
_x = N['dummy'].0
F.<rho> = NumberField(_x^2 - 2)
S.<a, b, c, d, A, B, C, D> = F[]
I = matrix(S, 2, [i, 0, 0, -i])
J = matrix(S, 2, [0, 1, -1, 0])
K = I*J
W = (-matrix.identity(S, 2) + I + J + K)/2
Hhat = gener([(J + K)/rho, W])
X = matrix(2, [a, b, c, d])
Y = matrix(2, [A, B, C, D])
T = {z.trace() for z in Hhat} - {-2, 2}
assert prod(A - t for t in T) == A^5 + (-3)*A^3 + 2*A
txy = X.trace()*Y.trace() - (X*Y).trace()
det = X.det()
for m in [0, 1, 2]:
    s = sum((h*Y).trace()*(h*X).trace()^(2*m+1) for h in Hhat)
    assert 2*s == len(Hhat)*catal[m]*txy*det^m

# H = A_5 (Case (f))
N.<i> = QuadraticField(-1)
_x = N['dummy'].0
F.<sig> = NumberField(_x^2 + _x - 1)
S.<a, b, c, d, A, B, C, D> = F[]
I = matrix(S, 2, [i, 0, 0, -i])
J = matrix(S, 2, [0, 1, -1, 0])
K = I*J
W = (-matrix.identity(S, 2) + I + J + K)/2
Hhat = gener([I/2 + J*sig/2 + K*(sig+1)/2, W])
X = matrix(2, [a, b, c, d])
Y = matrix(2, [A, B, C, D])
T = {z.trace() for z in Hhat} - {-2, 2}
assert prod(A - t for t in T) == A^7 + (-4)*A^5 + 4*A^3 - A
txy = X.trace()*Y.trace() - (X*Y).trace()
det = X.det()
for m in [0, 1, 2, 3, 4]:
    s = sum((h*Y).trace()*(h*X).trace()^(2*m+1) for h in Hhat)
    assert 2*s == len(Hhat)*catal[m]*txy*det^m</script>
    </div></LI>
    <LI> Only view the code (copy and paste should work):
  <pre><code class="language-python">
def fibonacci(n):
    if n <= 1:
        return n
    return fibonacci(n-1) + fibonacci(n-2)
	    </code></pre>
    </LI>
  </UL>
  <p><a href="index.html">Back to top</a></p>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
</body>
</html>
